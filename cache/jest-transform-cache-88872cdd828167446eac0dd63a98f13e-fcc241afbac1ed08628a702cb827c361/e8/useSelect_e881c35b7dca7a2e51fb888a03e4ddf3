9ead00e3500de5352c8b283f4198af5d
"use strict";
'use client';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useSelect = useSelect;
var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
var React = _interopRequireWildcard(require("react"));
var _utils = require("@mui/utils");
var _useButton = require("../useButton");
var _useSelect = require("./useSelect.types");
var _useList = require("../useList");
var _defaultOptionStringifier = require("./defaultOptionStringifier");
var _useCompound = require("../utils/useCompound");
var _selectReducer = require("./selectReducer");
var _combineHooksSlotProps = require("../utils/combineHooksSlotProps");
function _getRequireWildcardCache(nodeInterop) {
  if (typeof WeakMap !== "function") return null;
  var cacheBabelInterop = new WeakMap();
  var cacheNodeInterop = new WeakMap();
  return (_getRequireWildcardCache = function (nodeInterop) {
    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
  })(nodeInterop);
}
function _interopRequireWildcard(obj, nodeInterop) {
  if (!nodeInterop && obj && obj.__esModule) {
    return obj;
  }
  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }
  var cache = _getRequireWildcardCache(nodeInterop);
  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }
  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }
  newObj.default = obj;
  if (cache) {
    cache.set(obj, newObj);
  }
  return newObj;
}
function preventDefault(event) {
  event.preventDefault();
}

/**
 *
 * Demos:
 *
 * - [Select](https://mui.com/base-ui/react-select/#hooks)
 *
 * API:
 *
 * - [useSelect API](https://mui.com/base-ui/react-select/hooks-api/#use-select)
 */
function useSelect(props) {
  const {
    areOptionsEqual,
    buttonRef: buttonRefProp,
    defaultOpen = false,
    defaultValue: defaultValueProp,
    disabled = false,
    listboxId: listboxIdProp,
    listboxRef: listboxRefProp,
    multiple = false,
    onChange,
    onHighlightChange,
    onOpenChange,
    open: openProp,
    options: optionsParam,
    getOptionAsString = _defaultOptionStringifier.defaultOptionStringifier,
    value: valueProp
  } = props;
  const buttonRef = React.useRef(null);
  const handleButtonRef = (0, _utils.unstable_useForkRef)(buttonRefProp, buttonRef);
  const listboxRef = React.useRef(null);
  const listboxId = (0, _utils.unstable_useId)(listboxIdProp);
  let defaultValue;
  if (valueProp === undefined && defaultValueProp === undefined) {
    defaultValue = [];
  } else if (defaultValueProp !== undefined) {
    if (multiple) {
      defaultValue = defaultValueProp;
    } else {
      defaultValue = defaultValueProp == null ? [] : [defaultValueProp];
    }
  }
  const value = React.useMemo(() => {
    if (valueProp !== undefined) {
      if (multiple) {
        return valueProp;
      }
      return valueProp == null ? [] : [valueProp];
    }
    return undefined;
  }, [valueProp, multiple]);
  const {
    subitems,
    contextValue: compoundComponentContextValue
  } = (0, _useCompound.useCompoundParent)();
  const options = React.useMemo(() => {
    if (optionsParam != null) {
      return new Map(optionsParam.map((option, index) => [option.value, {
        value: option.value,
        label: option.label,
        disabled: option.disabled,
        ref: /*#__PURE__*/React.createRef(),
        id: `${listboxId}_${index}`
      }]));
    }
    return subitems;
  }, [optionsParam, subitems, listboxId]);
  const handleListboxRef = (0, _utils.unstable_useForkRef)(listboxRefProp, listboxRef);
  const {
    getRootProps: getButtonRootProps,
    active: buttonActive,
    focusVisible: buttonFocusVisible,
    rootRef: mergedButtonRef
  } = (0, _useButton.useButton)({
    disabled,
    rootRef: handleButtonRef
  });
  const optionValues = React.useMemo(() => Array.from(options.keys()), [options]);
  const getOptionByValue = React.useCallback(valueToGet => {
    // This can't be simply `options.get(valueToGet)` because of the `areOptionsEqual` prop.
    // If it's provided, we assume that the user wants to compare the options by value.
    if (areOptionsEqual !== undefined) {
      const similarValue = optionValues.find(optionValue => areOptionsEqual(optionValue, valueToGet));
      return options.get(similarValue);
    }
    return options.get(valueToGet);
  }, [options, areOptionsEqual, optionValues]);
  const isItemDisabled = React.useCallback(valueToCheck => {
    var _option$disabled;
    const option = getOptionByValue(valueToCheck);
    return (_option$disabled = option == null ? void 0 : option.disabled) != null ? _option$disabled : false;
  }, [getOptionByValue]);
  const stringifyOption = React.useCallback(valueToCheck => {
    const option = getOptionByValue(valueToCheck);
    if (!option) {
      return '';
    }
    return getOptionAsString(option);
  }, [getOptionByValue, getOptionAsString]);
  const controlledState = React.useMemo(() => ({
    selectedValues: value,
    open: openProp
  }), [value, openProp]);
  const getItemId = React.useCallback(itemValue => {
    var _options$get;
    return (_options$get = options.get(itemValue)) == null ? void 0 : _options$get.id;
  }, [options]);
  const handleSelectionChange = React.useCallback((event, newValues) => {
    if (multiple) {
      onChange == null ? void 0 : onChange(event, newValues);
    } else {
      var _newValues$;
      onChange == null ? void 0 : onChange(event, (_newValues$ = newValues[0]) != null ? _newValues$ : null);
    }
  }, [multiple, onChange]);
  const handleHighlightChange = React.useCallback((event, newValue) => {
    onHighlightChange == null ? void 0 : onHighlightChange(event, newValue != null ? newValue : null);
  }, [onHighlightChange]);
  const handleStateChange = React.useCallback((event, field, fieldValue) => {
    if (field === 'open') {
      onOpenChange == null ? void 0 : onOpenChange(fieldValue);
      if (fieldValue === false && (event == null ? void 0 : event.type) !== 'blur') {
        var _buttonRef$current;
        (_buttonRef$current = buttonRef.current) == null ? void 0 : _buttonRef$current.focus();
      }
    }
  }, [onOpenChange]);
  const useListParameters = {
    getInitialState: () => {
      var _defaultValue;
      return {
        highlightedValue: null,
        selectedValues: (_defaultValue = defaultValue) != null ? _defaultValue : [],
        open: defaultOpen
      };
    },
    getItemId,
    controlledProps: controlledState,
    itemComparer: areOptionsEqual,
    isItemDisabled,
    rootRef: mergedButtonRef,
    onChange: handleSelectionChange,
    onHighlightChange: handleHighlightChange,
    onStateChange: handleStateChange,
    reducerActionContext: React.useMemo(() => ({
      multiple
    }), [multiple]),
    items: optionValues,
    getItemAsString: stringifyOption,
    selectionMode: multiple ? 'multiple' : 'single',
    stateReducer: _selectReducer.selectReducer
  };
  const {
    dispatch,
    getRootProps: getListboxRootProps,
    contextValue: listContextValue,
    state: {
      open,
      highlightedValue: highlightedOption,
      selectedValues: selectedOptions
    },
    rootRef: mergedListRootRef
  } = (0, _useList.useList)(useListParameters);
  const createHandleButtonMouseDown = otherHandlers => event => {
    var _otherHandlers$onMous;
    otherHandlers == null || (_otherHandlers$onMous = otherHandlers.onMouseDown) == null ? void 0 : _otherHandlers$onMous.call(otherHandlers, event);
    if (!event.defaultMuiPrevented) {
      const action = {
        type: _useSelect.SelectActionTypes.buttonClick,
        event
      };
      dispatch(action);
    }
  };
  (0, _utils.unstable_useEnhancedEffect)(() => {
    // Scroll to the currently highlighted option.
    if (highlightedOption != null) {
      var _getOptionByValue;
      const optionRef = (_getOptionByValue = getOptionByValue(highlightedOption)) == null ? void 0 : _getOptionByValue.ref;
      if (!listboxRef.current || !(optionRef != null && optionRef.current)) {
        return;
      }
      const listboxClientRect = listboxRef.current.getBoundingClientRect();
      const optionClientRect = optionRef.current.getBoundingClientRect();
      if (optionClientRect.top < listboxClientRect.top) {
        listboxRef.current.scrollTop -= listboxClientRect.top - optionClientRect.top;
      } else if (optionClientRect.bottom > listboxClientRect.bottom) {
        listboxRef.current.scrollTop += optionClientRect.bottom - listboxClientRect.bottom;
      }
    }
  }, [highlightedOption, getOptionByValue]);
  const getOptionMetadata = React.useCallback(optionValue => getOptionByValue(optionValue), [getOptionByValue]);
  const getSelectTriggerProps = (otherHandlers = {}) => {
    return (0, _extends2.default)({}, otherHandlers, {
      onMouseDown: createHandleButtonMouseDown(otherHandlers),
      ref: mergedListRootRef,
      role: 'combobox',
      'aria-expanded': open,
      'aria-controls': listboxId
    });
  };
  const getButtonProps = (otherHandlers = {}) => {
    const listboxAndButtonProps = (0, _combineHooksSlotProps.combineHooksSlotProps)(getButtonRootProps, getListboxRootProps);
    const combinedProps = (0, _combineHooksSlotProps.combineHooksSlotProps)(listboxAndButtonProps, getSelectTriggerProps);
    return combinedProps(otherHandlers);
  };
  const getListboxProps = (otherHandlers = {}) => {
    return (0, _extends2.default)({}, otherHandlers, {
      id: listboxId,
      role: 'listbox',
      'aria-multiselectable': multiple ? 'true' : undefined,
      ref: handleListboxRef,
      onMouseDown: preventDefault // to prevent the button from losing focus when interacting with the listbox
    });
  };

  React.useDebugValue({
    selectedOptions,
    highlightedOption,
    open
  });
  const contextValue = React.useMemo(() => (0, _extends2.default)({}, listContextValue, compoundComponentContextValue), [listContextValue, compoundComponentContextValue]);
  let selectValue;
  if (props.multiple) {
    selectValue = selectedOptions;
  } else {
    selectValue = selectedOptions.length > 0 ? selectedOptions[0] : null;
  }
  return {
    buttonActive,
    buttonFocusVisible,
    buttonRef: mergedButtonRef,
    contextValue,
    disabled,
    dispatch,
    getButtonProps,
    getListboxProps,
    getOptionMetadata,
    listboxRef: mergedListRootRef,
    open,
    options: optionValues,
    value: selectValue,
    highlightedOption
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwidXNlU2VsZWN0IiwiX2V4dGVuZHMyIiwiUmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIl91dGlscyIsIl91c2VCdXR0b24iLCJfdXNlU2VsZWN0IiwiX3VzZUxpc3QiLCJfZGVmYXVsdE9wdGlvblN0cmluZ2lmaWVyIiwiX3VzZUNvbXBvdW5kIiwiX3NlbGVjdFJlZHVjZXIiLCJfY29tYmluZUhvb2tzU2xvdFByb3BzIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwibm9kZUludGVyb3AiLCJXZWFrTWFwIiwiY2FjaGVCYWJlbEludGVyb3AiLCJjYWNoZU5vZGVJbnRlcm9wIiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJjYWNoZSIsImhhcyIsImdldCIsIm5ld09iaiIsImhhc1Byb3BlcnR5RGVzY3JpcHRvciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRlc2MiLCJzZXQiLCJwcmV2ZW50RGVmYXVsdCIsImV2ZW50IiwicHJvcHMiLCJhcmVPcHRpb25zRXF1YWwiLCJidXR0b25SZWYiLCJidXR0b25SZWZQcm9wIiwiZGVmYXVsdE9wZW4iLCJkZWZhdWx0VmFsdWUiLCJkZWZhdWx0VmFsdWVQcm9wIiwiZGlzYWJsZWQiLCJsaXN0Ym94SWQiLCJsaXN0Ym94SWRQcm9wIiwibGlzdGJveFJlZiIsImxpc3Rib3hSZWZQcm9wIiwibXVsdGlwbGUiLCJvbkNoYW5nZSIsIm9uSGlnaGxpZ2h0Q2hhbmdlIiwib25PcGVuQ2hhbmdlIiwib3BlbiIsIm9wZW5Qcm9wIiwib3B0aW9ucyIsIm9wdGlvbnNQYXJhbSIsImdldE9wdGlvbkFzU3RyaW5nIiwiZGVmYXVsdE9wdGlvblN0cmluZ2lmaWVyIiwidmFsdWVQcm9wIiwidXNlUmVmIiwiaGFuZGxlQnV0dG9uUmVmIiwidW5zdGFibGVfdXNlRm9ya1JlZiIsInVuc3RhYmxlX3VzZUlkIiwidW5kZWZpbmVkIiwidXNlTWVtbyIsInN1Yml0ZW1zIiwiY29udGV4dFZhbHVlIiwiY29tcG91bmRDb21wb25lbnRDb250ZXh0VmFsdWUiLCJ1c2VDb21wb3VuZFBhcmVudCIsIk1hcCIsIm1hcCIsIm9wdGlvbiIsImluZGV4IiwibGFiZWwiLCJyZWYiLCJjcmVhdGVSZWYiLCJpZCIsImhhbmRsZUxpc3Rib3hSZWYiLCJnZXRSb290UHJvcHMiLCJnZXRCdXR0b25Sb290UHJvcHMiLCJhY3RpdmUiLCJidXR0b25BY3RpdmUiLCJmb2N1c1Zpc2libGUiLCJidXR0b25Gb2N1c1Zpc2libGUiLCJyb290UmVmIiwibWVyZ2VkQnV0dG9uUmVmIiwidXNlQnV0dG9uIiwib3B0aW9uVmFsdWVzIiwiQXJyYXkiLCJmcm9tIiwia2V5cyIsImdldE9wdGlvbkJ5VmFsdWUiLCJ1c2VDYWxsYmFjayIsInZhbHVlVG9HZXQiLCJzaW1pbGFyVmFsdWUiLCJmaW5kIiwib3B0aW9uVmFsdWUiLCJpc0l0ZW1EaXNhYmxlZCIsInZhbHVlVG9DaGVjayIsIl9vcHRpb24kZGlzYWJsZWQiLCJzdHJpbmdpZnlPcHRpb24iLCJjb250cm9sbGVkU3RhdGUiLCJzZWxlY3RlZFZhbHVlcyIsImdldEl0ZW1JZCIsIml0ZW1WYWx1ZSIsIl9vcHRpb25zJGdldCIsImhhbmRsZVNlbGVjdGlvbkNoYW5nZSIsIm5ld1ZhbHVlcyIsIl9uZXdWYWx1ZXMkIiwiaGFuZGxlSGlnaGxpZ2h0Q2hhbmdlIiwibmV3VmFsdWUiLCJoYW5kbGVTdGF0ZUNoYW5nZSIsImZpZWxkIiwiZmllbGRWYWx1ZSIsInR5cGUiLCJfYnV0dG9uUmVmJGN1cnJlbnQiLCJjdXJyZW50IiwiZm9jdXMiLCJ1c2VMaXN0UGFyYW1ldGVycyIsImdldEluaXRpYWxTdGF0ZSIsIl9kZWZhdWx0VmFsdWUiLCJoaWdobGlnaHRlZFZhbHVlIiwiY29udHJvbGxlZFByb3BzIiwiaXRlbUNvbXBhcmVyIiwib25TdGF0ZUNoYW5nZSIsInJlZHVjZXJBY3Rpb25Db250ZXh0IiwiaXRlbXMiLCJnZXRJdGVtQXNTdHJpbmciLCJzZWxlY3Rpb25Nb2RlIiwic3RhdGVSZWR1Y2VyIiwic2VsZWN0UmVkdWNlciIsImRpc3BhdGNoIiwiZ2V0TGlzdGJveFJvb3RQcm9wcyIsImxpc3RDb250ZXh0VmFsdWUiLCJzdGF0ZSIsImhpZ2hsaWdodGVkT3B0aW9uIiwic2VsZWN0ZWRPcHRpb25zIiwibWVyZ2VkTGlzdFJvb3RSZWYiLCJ1c2VMaXN0IiwiY3JlYXRlSGFuZGxlQnV0dG9uTW91c2VEb3duIiwib3RoZXJIYW5kbGVycyIsIl9vdGhlckhhbmRsZXJzJG9uTW91cyIsIm9uTW91c2VEb3duIiwiZGVmYXVsdE11aVByZXZlbnRlZCIsImFjdGlvbiIsIlNlbGVjdEFjdGlvblR5cGVzIiwiYnV0dG9uQ2xpY2siLCJ1bnN0YWJsZV91c2VFbmhhbmNlZEVmZmVjdCIsIl9nZXRPcHRpb25CeVZhbHVlIiwib3B0aW9uUmVmIiwibGlzdGJveENsaWVudFJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvcHRpb25DbGllbnRSZWN0IiwidG9wIiwic2Nyb2xsVG9wIiwiYm90dG9tIiwiZ2V0T3B0aW9uTWV0YWRhdGEiLCJnZXRTZWxlY3RUcmlnZ2VyUHJvcHMiLCJyb2xlIiwiZ2V0QnV0dG9uUHJvcHMiLCJsaXN0Ym94QW5kQnV0dG9uUHJvcHMiLCJjb21iaW5lSG9va3NTbG90UHJvcHMiLCJjb21iaW5lZFByb3BzIiwiZ2V0TGlzdGJveFByb3BzIiwidXNlRGVidWdWYWx1ZSIsInNlbGVjdFZhbHVlIiwibGVuZ3RoIl0sInNvdXJjZXMiOlsidXNlU2VsZWN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuJ3VzZSBjbGllbnQnO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnVzZVNlbGVjdCA9IHVzZVNlbGVjdDtcbnZhciBfZXh0ZW5kczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2V4dGVuZHNcIikpO1xudmFyIFJlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZShcInJlYWN0XCIpKTtcbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiQG11aS91dGlsc1wiKTtcbnZhciBfdXNlQnV0dG9uID0gcmVxdWlyZShcIi4uL3VzZUJ1dHRvblwiKTtcbnZhciBfdXNlU2VsZWN0ID0gcmVxdWlyZShcIi4vdXNlU2VsZWN0LnR5cGVzXCIpO1xudmFyIF91c2VMaXN0ID0gcmVxdWlyZShcIi4uL3VzZUxpc3RcIik7XG52YXIgX2RlZmF1bHRPcHRpb25TdHJpbmdpZmllciA9IHJlcXVpcmUoXCIuL2RlZmF1bHRPcHRpb25TdHJpbmdpZmllclwiKTtcbnZhciBfdXNlQ29tcG91bmQgPSByZXF1aXJlKFwiLi4vdXRpbHMvdXNlQ29tcG91bmRcIik7XG52YXIgX3NlbGVjdFJlZHVjZXIgPSByZXF1aXJlKFwiLi9zZWxlY3RSZWR1Y2VyXCIpO1xudmFyIF9jb21iaW5lSG9va3NTbG90UHJvcHMgPSByZXF1aXJlKFwiLi4vdXRpbHMvY29tYmluZUhvb2tzU2xvdFByb3BzXCIpO1xuZnVuY3Rpb24gX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlKG5vZGVJbnRlcm9wKSB7IGlmICh0eXBlb2YgV2Vha01hcCAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gbnVsbDsgdmFyIGNhY2hlQmFiZWxJbnRlcm9wID0gbmV3IFdlYWtNYXAoKTsgdmFyIGNhY2hlTm9kZUludGVyb3AgPSBuZXcgV2Vha01hcCgpOyByZXR1cm4gKF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSA9IGZ1bmN0aW9uIChub2RlSW50ZXJvcCkgeyByZXR1cm4gbm9kZUludGVyb3AgPyBjYWNoZU5vZGVJbnRlcm9wIDogY2FjaGVCYWJlbEludGVyb3A7IH0pKG5vZGVJbnRlcm9wKTsgfVxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqLCBub2RlSW50ZXJvcCkgeyBpZiAoIW5vZGVJbnRlcm9wICYmIG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2Ygb2JqICE9PSBcImZ1bmN0aW9uXCIpIHsgcmV0dXJuIHsgZGVmYXVsdDogb2JqIH07IH0gdmFyIGNhY2hlID0gX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlKG5vZGVJbnRlcm9wKTsgaWYgKGNhY2hlICYmIGNhY2hlLmhhcyhvYmopKSB7IHJldHVybiBjYWNoZS5nZXQob2JqKTsgfSB2YXIgbmV3T2JqID0ge307IHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoa2V5ICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gaGFzUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiBudWxsOyBpZiAoZGVzYyAmJiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyBpZiAoY2FjaGUpIHsgY2FjaGUuc2V0KG9iaiwgbmV3T2JqKTsgfSByZXR1cm4gbmV3T2JqOyB9XG5mdW5jdGlvbiBwcmV2ZW50RGVmYXVsdChldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xufVxuXG4vKipcbiAqXG4gKiBEZW1vczpcbiAqXG4gKiAtIFtTZWxlY3RdKGh0dHBzOi8vbXVpLmNvbS9iYXNlLXVpL3JlYWN0LXNlbGVjdC8jaG9va3MpXG4gKlxuICogQVBJOlxuICpcbiAqIC0gW3VzZVNlbGVjdCBBUEldKGh0dHBzOi8vbXVpLmNvbS9iYXNlLXVpL3JlYWN0LXNlbGVjdC9ob29rcy1hcGkvI3VzZS1zZWxlY3QpXG4gKi9cbmZ1bmN0aW9uIHVzZVNlbGVjdChwcm9wcykge1xuICBjb25zdCB7XG4gICAgYXJlT3B0aW9uc0VxdWFsLFxuICAgIGJ1dHRvblJlZjogYnV0dG9uUmVmUHJvcCxcbiAgICBkZWZhdWx0T3BlbiA9IGZhbHNlLFxuICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdFZhbHVlUHJvcCxcbiAgICBkaXNhYmxlZCA9IGZhbHNlLFxuICAgIGxpc3Rib3hJZDogbGlzdGJveElkUHJvcCxcbiAgICBsaXN0Ym94UmVmOiBsaXN0Ym94UmVmUHJvcCxcbiAgICBtdWx0aXBsZSA9IGZhbHNlLFxuICAgIG9uQ2hhbmdlLFxuICAgIG9uSGlnaGxpZ2h0Q2hhbmdlLFxuICAgIG9uT3BlbkNoYW5nZSxcbiAgICBvcGVuOiBvcGVuUHJvcCxcbiAgICBvcHRpb25zOiBvcHRpb25zUGFyYW0sXG4gICAgZ2V0T3B0aW9uQXNTdHJpbmcgPSBfZGVmYXVsdE9wdGlvblN0cmluZ2lmaWVyLmRlZmF1bHRPcHRpb25TdHJpbmdpZmllcixcbiAgICB2YWx1ZTogdmFsdWVQcm9wXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgYnV0dG9uUmVmID0gUmVhY3QudXNlUmVmKG51bGwpO1xuICBjb25zdCBoYW5kbGVCdXR0b25SZWYgPSAoMCwgX3V0aWxzLnVuc3RhYmxlX3VzZUZvcmtSZWYpKGJ1dHRvblJlZlByb3AsIGJ1dHRvblJlZik7XG4gIGNvbnN0IGxpc3Rib3hSZWYgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIGNvbnN0IGxpc3Rib3hJZCA9ICgwLCBfdXRpbHMudW5zdGFibGVfdXNlSWQpKGxpc3Rib3hJZFByb3ApO1xuICBsZXQgZGVmYXVsdFZhbHVlO1xuICBpZiAodmFsdWVQcm9wID09PSB1bmRlZmluZWQgJiYgZGVmYXVsdFZhbHVlUHJvcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZGVmYXVsdFZhbHVlID0gW107XG4gIH0gZWxzZSBpZiAoZGVmYXVsdFZhbHVlUHJvcCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKG11bHRpcGxlKSB7XG4gICAgICBkZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWVQcm9wO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWVQcm9wID09IG51bGwgPyBbXSA6IFtkZWZhdWx0VmFsdWVQcm9wXTtcbiAgICB9XG4gIH1cbiAgY29uc3QgdmFsdWUgPSBSZWFjdC51c2VNZW1vKCgpID0+IHtcbiAgICBpZiAodmFsdWVQcm9wICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChtdWx0aXBsZSkge1xuICAgICAgICByZXR1cm4gdmFsdWVQcm9wO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlUHJvcCA9PSBudWxsID8gW10gOiBbdmFsdWVQcm9wXTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfSwgW3ZhbHVlUHJvcCwgbXVsdGlwbGVdKTtcbiAgY29uc3Qge1xuICAgIHN1Yml0ZW1zLFxuICAgIGNvbnRleHRWYWx1ZTogY29tcG91bmRDb21wb25lbnRDb250ZXh0VmFsdWVcbiAgfSA9ICgwLCBfdXNlQ29tcG91bmQudXNlQ29tcG91bmRQYXJlbnQpKCk7XG4gIGNvbnN0IG9wdGlvbnMgPSBSZWFjdC51c2VNZW1vKCgpID0+IHtcbiAgICBpZiAob3B0aW9uc1BhcmFtICE9IG51bGwpIHtcbiAgICAgIHJldHVybiBuZXcgTWFwKG9wdGlvbnNQYXJhbS5tYXAoKG9wdGlvbiwgaW5kZXgpID0+IFtvcHRpb24udmFsdWUsIHtcbiAgICAgICAgdmFsdWU6IG9wdGlvbi52YWx1ZSxcbiAgICAgICAgbGFiZWw6IG9wdGlvbi5sYWJlbCxcbiAgICAgICAgZGlzYWJsZWQ6IG9wdGlvbi5kaXNhYmxlZCxcbiAgICAgICAgcmVmOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlUmVmKCksXG4gICAgICAgIGlkOiBgJHtsaXN0Ym94SWR9XyR7aW5kZXh9YFxuICAgICAgfV0pKTtcbiAgICB9XG4gICAgcmV0dXJuIHN1Yml0ZW1zO1xuICB9LCBbb3B0aW9uc1BhcmFtLCBzdWJpdGVtcywgbGlzdGJveElkXSk7XG4gIGNvbnN0IGhhbmRsZUxpc3Rib3hSZWYgPSAoMCwgX3V0aWxzLnVuc3RhYmxlX3VzZUZvcmtSZWYpKGxpc3Rib3hSZWZQcm9wLCBsaXN0Ym94UmVmKTtcbiAgY29uc3Qge1xuICAgIGdldFJvb3RQcm9wczogZ2V0QnV0dG9uUm9vdFByb3BzLFxuICAgIGFjdGl2ZTogYnV0dG9uQWN0aXZlLFxuICAgIGZvY3VzVmlzaWJsZTogYnV0dG9uRm9jdXNWaXNpYmxlLFxuICAgIHJvb3RSZWY6IG1lcmdlZEJ1dHRvblJlZlxuICB9ID0gKDAsIF91c2VCdXR0b24udXNlQnV0dG9uKSh7XG4gICAgZGlzYWJsZWQsXG4gICAgcm9vdFJlZjogaGFuZGxlQnV0dG9uUmVmXG4gIH0pO1xuICBjb25zdCBvcHRpb25WYWx1ZXMgPSBSZWFjdC51c2VNZW1vKCgpID0+IEFycmF5LmZyb20ob3B0aW9ucy5rZXlzKCkpLCBbb3B0aW9uc10pO1xuICBjb25zdCBnZXRPcHRpb25CeVZhbHVlID0gUmVhY3QudXNlQ2FsbGJhY2sodmFsdWVUb0dldCA9PiB7XG4gICAgLy8gVGhpcyBjYW4ndCBiZSBzaW1wbHkgYG9wdGlvbnMuZ2V0KHZhbHVlVG9HZXQpYCBiZWNhdXNlIG9mIHRoZSBgYXJlT3B0aW9uc0VxdWFsYCBwcm9wLlxuICAgIC8vIElmIGl0J3MgcHJvdmlkZWQsIHdlIGFzc3VtZSB0aGF0IHRoZSB1c2VyIHdhbnRzIHRvIGNvbXBhcmUgdGhlIG9wdGlvbnMgYnkgdmFsdWUuXG4gICAgaWYgKGFyZU9wdGlvbnNFcXVhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBzaW1pbGFyVmFsdWUgPSBvcHRpb25WYWx1ZXMuZmluZChvcHRpb25WYWx1ZSA9PiBhcmVPcHRpb25zRXF1YWwob3B0aW9uVmFsdWUsIHZhbHVlVG9HZXQpKTtcbiAgICAgIHJldHVybiBvcHRpb25zLmdldChzaW1pbGFyVmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gb3B0aW9ucy5nZXQodmFsdWVUb0dldCk7XG4gIH0sIFtvcHRpb25zLCBhcmVPcHRpb25zRXF1YWwsIG9wdGlvblZhbHVlc10pO1xuICBjb25zdCBpc0l0ZW1EaXNhYmxlZCA9IFJlYWN0LnVzZUNhbGxiYWNrKHZhbHVlVG9DaGVjayA9PiB7XG4gICAgdmFyIF9vcHRpb24kZGlzYWJsZWQ7XG4gICAgY29uc3Qgb3B0aW9uID0gZ2V0T3B0aW9uQnlWYWx1ZSh2YWx1ZVRvQ2hlY2spO1xuICAgIHJldHVybiAoX29wdGlvbiRkaXNhYmxlZCA9IG9wdGlvbiA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9uLmRpc2FibGVkKSAhPSBudWxsID8gX29wdGlvbiRkaXNhYmxlZCA6IGZhbHNlO1xuICB9LCBbZ2V0T3B0aW9uQnlWYWx1ZV0pO1xuICBjb25zdCBzdHJpbmdpZnlPcHRpb24gPSBSZWFjdC51c2VDYWxsYmFjayh2YWx1ZVRvQ2hlY2sgPT4ge1xuICAgIGNvbnN0IG9wdGlvbiA9IGdldE9wdGlvbkJ5VmFsdWUodmFsdWVUb0NoZWNrKTtcbiAgICBpZiAoIW9wdGlvbikge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gZ2V0T3B0aW9uQXNTdHJpbmcob3B0aW9uKTtcbiAgfSwgW2dldE9wdGlvbkJ5VmFsdWUsIGdldE9wdGlvbkFzU3RyaW5nXSk7XG4gIGNvbnN0IGNvbnRyb2xsZWRTdGF0ZSA9IFJlYWN0LnVzZU1lbW8oKCkgPT4gKHtcbiAgICBzZWxlY3RlZFZhbHVlczogdmFsdWUsXG4gICAgb3Blbjogb3BlblByb3BcbiAgfSksIFt2YWx1ZSwgb3BlblByb3BdKTtcbiAgY29uc3QgZ2V0SXRlbUlkID0gUmVhY3QudXNlQ2FsbGJhY2soaXRlbVZhbHVlID0+IHtcbiAgICB2YXIgX29wdGlvbnMkZ2V0O1xuICAgIHJldHVybiAoX29wdGlvbnMkZ2V0ID0gb3B0aW9ucy5nZXQoaXRlbVZhbHVlKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9vcHRpb25zJGdldC5pZDtcbiAgfSwgW29wdGlvbnNdKTtcbiAgY29uc3QgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlID0gUmVhY3QudXNlQ2FsbGJhY2soKGV2ZW50LCBuZXdWYWx1ZXMpID0+IHtcbiAgICBpZiAobXVsdGlwbGUpIHtcbiAgICAgIG9uQ2hhbmdlID09IG51bGwgPyB2b2lkIDAgOiBvbkNoYW5nZShldmVudCwgbmV3VmFsdWVzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIF9uZXdWYWx1ZXMkO1xuICAgICAgb25DaGFuZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG9uQ2hhbmdlKGV2ZW50LCAoX25ld1ZhbHVlcyQgPSBuZXdWYWx1ZXNbMF0pICE9IG51bGwgPyBfbmV3VmFsdWVzJCA6IG51bGwpO1xuICAgIH1cbiAgfSwgW211bHRpcGxlLCBvbkNoYW5nZV0pO1xuICBjb25zdCBoYW5kbGVIaWdobGlnaHRDaGFuZ2UgPSBSZWFjdC51c2VDYWxsYmFjaygoZXZlbnQsIG5ld1ZhbHVlKSA9PiB7XG4gICAgb25IaWdobGlnaHRDaGFuZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG9uSGlnaGxpZ2h0Q2hhbmdlKGV2ZW50LCBuZXdWYWx1ZSAhPSBudWxsID8gbmV3VmFsdWUgOiBudWxsKTtcbiAgfSwgW29uSGlnaGxpZ2h0Q2hhbmdlXSk7XG4gIGNvbnN0IGhhbmRsZVN0YXRlQ2hhbmdlID0gUmVhY3QudXNlQ2FsbGJhY2soKGV2ZW50LCBmaWVsZCwgZmllbGRWYWx1ZSkgPT4ge1xuICAgIGlmIChmaWVsZCA9PT0gJ29wZW4nKSB7XG4gICAgICBvbk9wZW5DaGFuZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG9uT3BlbkNoYW5nZShmaWVsZFZhbHVlKTtcbiAgICAgIGlmIChmaWVsZFZhbHVlID09PSBmYWxzZSAmJiAoZXZlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IGV2ZW50LnR5cGUpICE9PSAnYmx1cicpIHtcbiAgICAgICAgdmFyIF9idXR0b25SZWYkY3VycmVudDtcbiAgICAgICAgKF9idXR0b25SZWYkY3VycmVudCA9IGJ1dHRvblJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2J1dHRvblJlZiRjdXJyZW50LmZvY3VzKCk7XG4gICAgICB9XG4gICAgfVxuICB9LCBbb25PcGVuQ2hhbmdlXSk7XG4gIGNvbnN0IHVzZUxpc3RQYXJhbWV0ZXJzID0ge1xuICAgIGdldEluaXRpYWxTdGF0ZTogKCkgPT4ge1xuICAgICAgdmFyIF9kZWZhdWx0VmFsdWU7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBoaWdobGlnaHRlZFZhbHVlOiBudWxsLFxuICAgICAgICBzZWxlY3RlZFZhbHVlczogKF9kZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWUpICE9IG51bGwgPyBfZGVmYXVsdFZhbHVlIDogW10sXG4gICAgICAgIG9wZW46IGRlZmF1bHRPcGVuXG4gICAgICB9O1xuICAgIH0sXG4gICAgZ2V0SXRlbUlkLFxuICAgIGNvbnRyb2xsZWRQcm9wczogY29udHJvbGxlZFN0YXRlLFxuICAgIGl0ZW1Db21wYXJlcjogYXJlT3B0aW9uc0VxdWFsLFxuICAgIGlzSXRlbURpc2FibGVkLFxuICAgIHJvb3RSZWY6IG1lcmdlZEJ1dHRvblJlZixcbiAgICBvbkNoYW5nZTogaGFuZGxlU2VsZWN0aW9uQ2hhbmdlLFxuICAgIG9uSGlnaGxpZ2h0Q2hhbmdlOiBoYW5kbGVIaWdobGlnaHRDaGFuZ2UsXG4gICAgb25TdGF0ZUNoYW5nZTogaGFuZGxlU3RhdGVDaGFuZ2UsXG4gICAgcmVkdWNlckFjdGlvbkNvbnRleHQ6IFJlYWN0LnVzZU1lbW8oKCkgPT4gKHtcbiAgICAgIG11bHRpcGxlXG4gICAgfSksIFttdWx0aXBsZV0pLFxuICAgIGl0ZW1zOiBvcHRpb25WYWx1ZXMsXG4gICAgZ2V0SXRlbUFzU3RyaW5nOiBzdHJpbmdpZnlPcHRpb24sXG4gICAgc2VsZWN0aW9uTW9kZTogbXVsdGlwbGUgPyAnbXVsdGlwbGUnIDogJ3NpbmdsZScsXG4gICAgc3RhdGVSZWR1Y2VyOiBfc2VsZWN0UmVkdWNlci5zZWxlY3RSZWR1Y2VyXG4gIH07XG4gIGNvbnN0IHtcbiAgICBkaXNwYXRjaCxcbiAgICBnZXRSb290UHJvcHM6IGdldExpc3Rib3hSb290UHJvcHMsXG4gICAgY29udGV4dFZhbHVlOiBsaXN0Q29udGV4dFZhbHVlLFxuICAgIHN0YXRlOiB7XG4gICAgICBvcGVuLFxuICAgICAgaGlnaGxpZ2h0ZWRWYWx1ZTogaGlnaGxpZ2h0ZWRPcHRpb24sXG4gICAgICBzZWxlY3RlZFZhbHVlczogc2VsZWN0ZWRPcHRpb25zXG4gICAgfSxcbiAgICByb290UmVmOiBtZXJnZWRMaXN0Um9vdFJlZlxuICB9ID0gKDAsIF91c2VMaXN0LnVzZUxpc3QpKHVzZUxpc3RQYXJhbWV0ZXJzKTtcbiAgY29uc3QgY3JlYXRlSGFuZGxlQnV0dG9uTW91c2VEb3duID0gb3RoZXJIYW5kbGVycyA9PiBldmVudCA9PiB7XG4gICAgdmFyIF9vdGhlckhhbmRsZXJzJG9uTW91cztcbiAgICBvdGhlckhhbmRsZXJzID09IG51bGwgfHwgKF9vdGhlckhhbmRsZXJzJG9uTW91cyA9IG90aGVySGFuZGxlcnMub25Nb3VzZURvd24pID09IG51bGwgPyB2b2lkIDAgOiBfb3RoZXJIYW5kbGVycyRvbk1vdXMuY2FsbChvdGhlckhhbmRsZXJzLCBldmVudCk7XG4gICAgaWYgKCFldmVudC5kZWZhdWx0TXVpUHJldmVudGVkKSB7XG4gICAgICBjb25zdCBhY3Rpb24gPSB7XG4gICAgICAgIHR5cGU6IF91c2VTZWxlY3QuU2VsZWN0QWN0aW9uVHlwZXMuYnV0dG9uQ2xpY2ssXG4gICAgICAgIGV2ZW50XG4gICAgICB9O1xuICAgICAgZGlzcGF0Y2goYWN0aW9uKTtcbiAgICB9XG4gIH07XG4gICgwLCBfdXRpbHMudW5zdGFibGVfdXNlRW5oYW5jZWRFZmZlY3QpKCgpID0+IHtcbiAgICAvLyBTY3JvbGwgdG8gdGhlIGN1cnJlbnRseSBoaWdobGlnaHRlZCBvcHRpb24uXG4gICAgaWYgKGhpZ2hsaWdodGVkT3B0aW9uICE9IG51bGwpIHtcbiAgICAgIHZhciBfZ2V0T3B0aW9uQnlWYWx1ZTtcbiAgICAgIGNvbnN0IG9wdGlvblJlZiA9IChfZ2V0T3B0aW9uQnlWYWx1ZSA9IGdldE9wdGlvbkJ5VmFsdWUoaGlnaGxpZ2h0ZWRPcHRpb24pKSA9PSBudWxsID8gdm9pZCAwIDogX2dldE9wdGlvbkJ5VmFsdWUucmVmO1xuICAgICAgaWYgKCFsaXN0Ym94UmVmLmN1cnJlbnQgfHwgIShvcHRpb25SZWYgIT0gbnVsbCAmJiBvcHRpb25SZWYuY3VycmVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgbGlzdGJveENsaWVudFJlY3QgPSBsaXN0Ym94UmVmLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBjb25zdCBvcHRpb25DbGllbnRSZWN0ID0gb3B0aW9uUmVmLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBpZiAob3B0aW9uQ2xpZW50UmVjdC50b3AgPCBsaXN0Ym94Q2xpZW50UmVjdC50b3ApIHtcbiAgICAgICAgbGlzdGJveFJlZi5jdXJyZW50LnNjcm9sbFRvcCAtPSBsaXN0Ym94Q2xpZW50UmVjdC50b3AgLSBvcHRpb25DbGllbnRSZWN0LnRvcDtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9uQ2xpZW50UmVjdC5ib3R0b20gPiBsaXN0Ym94Q2xpZW50UmVjdC5ib3R0b20pIHtcbiAgICAgICAgbGlzdGJveFJlZi5jdXJyZW50LnNjcm9sbFRvcCArPSBvcHRpb25DbGllbnRSZWN0LmJvdHRvbSAtIGxpc3Rib3hDbGllbnRSZWN0LmJvdHRvbTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtoaWdobGlnaHRlZE9wdGlvbiwgZ2V0T3B0aW9uQnlWYWx1ZV0pO1xuICBjb25zdCBnZXRPcHRpb25NZXRhZGF0YSA9IFJlYWN0LnVzZUNhbGxiYWNrKG9wdGlvblZhbHVlID0+IGdldE9wdGlvbkJ5VmFsdWUob3B0aW9uVmFsdWUpLCBbZ2V0T3B0aW9uQnlWYWx1ZV0pO1xuICBjb25zdCBnZXRTZWxlY3RUcmlnZ2VyUHJvcHMgPSAob3RoZXJIYW5kbGVycyA9IHt9KSA9PiB7XG4gICAgcmV0dXJuICgwLCBfZXh0ZW5kczIuZGVmYXVsdCkoe30sIG90aGVySGFuZGxlcnMsIHtcbiAgICAgIG9uTW91c2VEb3duOiBjcmVhdGVIYW5kbGVCdXR0b25Nb3VzZURvd24ob3RoZXJIYW5kbGVycyksXG4gICAgICByZWY6IG1lcmdlZExpc3RSb290UmVmLFxuICAgICAgcm9sZTogJ2NvbWJvYm94JyxcbiAgICAgICdhcmlhLWV4cGFuZGVkJzogb3BlbixcbiAgICAgICdhcmlhLWNvbnRyb2xzJzogbGlzdGJveElkXG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGdldEJ1dHRvblByb3BzID0gKG90aGVySGFuZGxlcnMgPSB7fSkgPT4ge1xuICAgIGNvbnN0IGxpc3Rib3hBbmRCdXR0b25Qcm9wcyA9ICgwLCBfY29tYmluZUhvb2tzU2xvdFByb3BzLmNvbWJpbmVIb29rc1Nsb3RQcm9wcykoZ2V0QnV0dG9uUm9vdFByb3BzLCBnZXRMaXN0Ym94Um9vdFByb3BzKTtcbiAgICBjb25zdCBjb21iaW5lZFByb3BzID0gKDAsIF9jb21iaW5lSG9va3NTbG90UHJvcHMuY29tYmluZUhvb2tzU2xvdFByb3BzKShsaXN0Ym94QW5kQnV0dG9uUHJvcHMsIGdldFNlbGVjdFRyaWdnZXJQcm9wcyk7XG4gICAgcmV0dXJuIGNvbWJpbmVkUHJvcHMob3RoZXJIYW5kbGVycyk7XG4gIH07XG4gIGNvbnN0IGdldExpc3Rib3hQcm9wcyA9IChvdGhlckhhbmRsZXJzID0ge30pID0+IHtcbiAgICByZXR1cm4gKDAsIF9leHRlbmRzMi5kZWZhdWx0KSh7fSwgb3RoZXJIYW5kbGVycywge1xuICAgICAgaWQ6IGxpc3Rib3hJZCxcbiAgICAgIHJvbGU6ICdsaXN0Ym94JyxcbiAgICAgICdhcmlhLW11bHRpc2VsZWN0YWJsZSc6IG11bHRpcGxlID8gJ3RydWUnIDogdW5kZWZpbmVkLFxuICAgICAgcmVmOiBoYW5kbGVMaXN0Ym94UmVmLFxuICAgICAgb25Nb3VzZURvd246IHByZXZlbnREZWZhdWx0IC8vIHRvIHByZXZlbnQgdGhlIGJ1dHRvbiBmcm9tIGxvc2luZyBmb2N1cyB3aGVuIGludGVyYWN0aW5nIHdpdGggdGhlIGxpc3Rib3hcbiAgICB9KTtcbiAgfTtcblxuICBSZWFjdC51c2VEZWJ1Z1ZhbHVlKHtcbiAgICBzZWxlY3RlZE9wdGlvbnMsXG4gICAgaGlnaGxpZ2h0ZWRPcHRpb24sXG4gICAgb3BlblxuICB9KTtcbiAgY29uc3QgY29udGV4dFZhbHVlID0gUmVhY3QudXNlTWVtbygoKSA9PiAoMCwgX2V4dGVuZHMyLmRlZmF1bHQpKHt9LCBsaXN0Q29udGV4dFZhbHVlLCBjb21wb3VuZENvbXBvbmVudENvbnRleHRWYWx1ZSksIFtsaXN0Q29udGV4dFZhbHVlLCBjb21wb3VuZENvbXBvbmVudENvbnRleHRWYWx1ZV0pO1xuICBsZXQgc2VsZWN0VmFsdWU7XG4gIGlmIChwcm9wcy5tdWx0aXBsZSkge1xuICAgIHNlbGVjdFZhbHVlID0gc2VsZWN0ZWRPcHRpb25zO1xuICB9IGVsc2Uge1xuICAgIHNlbGVjdFZhbHVlID0gc2VsZWN0ZWRPcHRpb25zLmxlbmd0aCA+IDAgPyBzZWxlY3RlZE9wdGlvbnNbMF0gOiBudWxsO1xuICB9XG4gIHJldHVybiB7XG4gICAgYnV0dG9uQWN0aXZlLFxuICAgIGJ1dHRvbkZvY3VzVmlzaWJsZSxcbiAgICBidXR0b25SZWY6IG1lcmdlZEJ1dHRvblJlZixcbiAgICBjb250ZXh0VmFsdWUsXG4gICAgZGlzYWJsZWQsXG4gICAgZGlzcGF0Y2gsXG4gICAgZ2V0QnV0dG9uUHJvcHMsXG4gICAgZ2V0TGlzdGJveFByb3BzLFxuICAgIGdldE9wdGlvbk1ldGFkYXRhLFxuICAgIGxpc3Rib3hSZWY6IG1lcmdlZExpc3RSb290UmVmLFxuICAgIG9wZW4sXG4gICAgb3B0aW9uczogb3B0aW9uVmFsdWVzLFxuICAgIHZhbHVlOiBzZWxlY3RWYWx1ZSxcbiAgICBoaWdobGlnaHRlZE9wdGlvblxuICB9O1xufSJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTtBQUNaLFlBQVk7O0FBRVosSUFBSUEsc0JBQXNCLEdBQUdDLE9BQU8sQ0FBQyw4Q0FBOEMsQ0FBQztBQUNwRkMsTUFBTSxDQUFDQyxjQUFjLENBQUNDLE9BQU8sRUFBRSxZQUFZLEVBQUU7RUFDM0NDLEtBQUssRUFBRTtBQUNULENBQUMsQ0FBQztBQUNGRCxPQUFPLENBQUNFLFNBQVMsR0FBR0EsU0FBUztBQUM3QixJQUFJQyxTQUFTLEdBQUdQLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztBQUNqRixJQUFJTyxLQUFLLEdBQUdDLHVCQUF1QixDQUFDUixPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDckQsSUFBSVMsTUFBTSxHQUFHVCxPQUFPLENBQUMsWUFBWSxDQUFDO0FBQ2xDLElBQUlVLFVBQVUsR0FBR1YsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUN4QyxJQUFJVyxVQUFVLEdBQUdYLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztBQUM3QyxJQUFJWSxRQUFRLEdBQUdaLE9BQU8sQ0FBQyxZQUFZLENBQUM7QUFDcEMsSUFBSWEseUJBQXlCLEdBQUdiLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQztBQUNyRSxJQUFJYyxZQUFZLEdBQUdkLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQztBQUNsRCxJQUFJZSxjQUFjLEdBQUdmLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztBQUMvQyxJQUFJZ0Isc0JBQXNCLEdBQUdoQixPQUFPLENBQUMsZ0NBQWdDLENBQUM7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