{"version":3,"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","useControllableReducer","_extends2","React","_interopRequireWildcard","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","areEqual","a","b","EMPTY_OBJECT","NOOP","getControlledState","internalState","controlledProps","augmentedState","keys","forEach","undefined","useStateChangeDetection","parameters","nextState","initialState","stateComparers","onStateChange","lastActionRef","internalPreviousStateRef","useRef","useEffect","current","previousState","_stateComparers$key","stateComparer","nextStateItem","previousStateItem","_event","_type","event","type","reducer","actionContext","reducerWithControlledState","useCallback","state","action","controlledState","newState","dispatch","useReducer","dispatchWithContext","context"],"sources":["useControllableReducer.js"],"sourcesContent":["\"use strict\";\n'use client';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useControllableReducer = useControllableReducer;\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\nvar React = _interopRequireWildcard(require(\"react\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction areEqual(a, b) {\n  return a === b;\n}\nconst EMPTY_OBJECT = {};\nconst NOOP = () => {};\n\n/**\n * Gets the current state augmented with controlled values from the outside.\n * If a state item has a corresponding controlled value, it will be used instead of the internal state.\n */\nfunction getControlledState(internalState, controlledProps) {\n  const augmentedState = (0, _extends2.default)({}, internalState);\n  Object.keys(controlledProps).forEach(key => {\n    if (controlledProps[key] !== undefined) {\n      augmentedState[key] = controlledProps[key];\n    }\n  });\n  return augmentedState;\n}\n/**\n * Defines an effect that compares the next state with the previous state and calls\n * the `onStateChange` callback if the state has changed.\n * The comparison is done based on the `stateComparers` parameter.\n */\nfunction useStateChangeDetection(parameters) {\n  const {\n    nextState,\n    initialState,\n    stateComparers,\n    onStateChange,\n    controlledProps,\n    lastActionRef\n  } = parameters;\n  const internalPreviousStateRef = React.useRef(initialState);\n  React.useEffect(() => {\n    if (lastActionRef.current === null) {\n      // Detect changes only if an action has been dispatched.\n      return;\n    }\n    const previousState = getControlledState(internalPreviousStateRef.current, controlledProps);\n    Object.keys(nextState).forEach(key => {\n      var _stateComparers$key;\n      // go through all state keys and compare them with the previous state\n      const stateComparer = (_stateComparers$key = stateComparers[key]) != null ? _stateComparers$key : areEqual;\n      const nextStateItem = nextState[key];\n      const previousStateItem = previousState[key];\n      if (previousStateItem == null && nextStateItem != null || previousStateItem != null && nextStateItem == null || previousStateItem != null && nextStateItem != null && !stateComparer(nextStateItem, previousStateItem)) {\n        var _event, _type;\n        onStateChange == null ? void 0 : onStateChange((_event = lastActionRef.current.event) != null ? _event : null, key, nextStateItem, (_type = lastActionRef.current.type) != null ? _type : '', nextState);\n      }\n    });\n    internalPreviousStateRef.current = nextState;\n    lastActionRef.current = null;\n  }, [internalPreviousStateRef, nextState, lastActionRef, onStateChange, stateComparers, controlledProps]);\n}\n\n/**\n * The alternative to `React.useReducer` that lets you control the state from the outside.\n *\n * It can be used in an uncontrolled mode, similar to `React.useReducer`, or in a controlled mode, when the state is controlled by the props.\n * It also supports partially controlled state, when some state items are controlled and some are not.\n *\n * The controlled state items are provided via the `controlledProps` parameter.\n * When a reducer action is dispatched, the internal state is updated with the new values.\n * A change event (`onStateChange`) is then triggered (for each changed state item) if the new state is different from the previous state.\n * This event can be used to update the controlled values.\n *\n * The comparison of the previous and next states is done using the `stateComparers` parameter.\n * If a state item has a corresponding comparer, it will be used to determine if the state has changed.\n * This is useful when the state item is an object and you want to compare only a subset of its properties or if it's an array and you want to compare its contents.\n *\n * An additional feature is the `actionContext` parameter. It allows you to add additional properties to every action object,\n * similarly to how React context is implicitly available to every component.\n *\n * @template State - The type of the state calculated by the reducer.\n * @template Action - The type of the actions that can be dispatched.\n * @template ActionContext - The type of the additional properties that will be added to every action object.\n *\n * @ignore - internal hook.\n */\nfunction useControllableReducer(parameters) {\n  const lastActionRef = React.useRef(null);\n  const {\n    reducer,\n    initialState,\n    controlledProps = EMPTY_OBJECT,\n    stateComparers = EMPTY_OBJECT,\n    onStateChange = NOOP,\n    actionContext\n  } = parameters;\n\n  // The reducer that is passed to React.useReducer is wrapped with a function that augments the state with controlled values.\n  const reducerWithControlledState = React.useCallback((state, action) => {\n    lastActionRef.current = action;\n    const controlledState = getControlledState(state, controlledProps);\n    const newState = reducer(controlledState, action);\n    return newState;\n  }, [controlledProps, reducer]);\n  const [nextState, dispatch] = React.useReducer(reducerWithControlledState, initialState);\n\n  // The action that is passed to dispatch is augmented with the actionContext.\n  const dispatchWithContext = React.useCallback(action => {\n    dispatch((0, _extends2.default)({}, action, {\n      context: actionContext\n    }));\n  }, [actionContext]);\n  useStateChangeDetection({\n    nextState,\n    initialState,\n    stateComparers: stateComparers != null ? stateComparers : EMPTY_OBJECT,\n    onStateChange: onStateChange != null ? onStateChange : NOOP,\n    controlledProps,\n    lastActionRef\n  });\n  return [getControlledState(nextState, controlledProps), dispatchWithContext];\n}"],"mappings":"AAAA,YAAY;AACZ,YAAY;;AAEZ,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAA8C,CAAC;AACpFC,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACE,sBAAsB,GAAGA,sBAAsB;AACvD,IAAIC,SAAS,GAAGP,sBAAsB,CAACC,OAAO,CAAC,gCAAgC,CAAC,CAAC;AACjF,IAAIO,KAAK,GAAGC,uBAAuB,CAACR,OAAO,CAAC,OAAO,CAAC,CAAC;AACrD,SAASS,wBAAwBA,CAACC,WAAW,EAAE;EAAE,IAAI,OAAOC,OAAO,KAAK,UAAU,EAAE,OAAO,IAAI;EAAE,IAAIC,iBAAiB,GAAG,IAAID,OAAO,EAAE;EAAE,IAAIE,gBAAgB,GAAG,IAAIF,OAAO,EAAE;EAAE,OAAO,CAACF,wBAAwB,GAAG,SAAAA,CAAUC,WAAW,EAAE;IAAE,OAAOA,WAAW,GAAGG,gBAAgB,GAAGD,iBAAiB;EAAE,CAAC,EAAEF,WAAW,CAAC;AAAE;AACtT,SAASF,uBAAuBA,CAACM,GAAG,EAAEJ,WAAW,EAAE;EAAE,IAAI,CAACA,WAAW,IAAII,GAAG,IAAIA,GAAG,CAACC,UAAU,EAAE;IAAE,OAAOD,GAAG;EAAE;EAAE,IAAIA,GAAG,KAAK,IAAI,IAAI,OAAOA,GAAG,KAAK,QAAQ,IAAI,OAAOA,GAAG,KAAK,UAAU,EAAE;IAAE,OAAO;MAAEE,OAAO,EAAEF;IAAI,CAAC;EAAE;EAAE,IAAIG,KAAK,GAAGR,wBAAwB,CAACC,WAAW,CAAC;EAAE,IAAIO,KAAK,IAAIA,KAAK,CAACC,GAAG,CAACJ,GAAG,CAAC,EAAE;IAAE,OAAOG,KAAK,CAACE,GAAG,CAACL,GAAG,CAAC;EAAE;EAAE,IAAIM,MAAM,GAAG,CAAC,CAAC;EAAE,IAAIC,qBAAqB,GAAGpB,MAAM,CAACC,cAAc,IAAID,MAAM,CAACqB,wBAAwB;EAAE,KAAK,IAAIC,GAAG,IAAIT,GAAG,EAAE;IAAE,IAAIS,GAAG,KAAK,SAAS,IAAItB,MAAM,CAACuB,SAAS,CAACC,cAAc,CAACC,IAAI,CAACZ,GAAG,EAAES,GAAG,CAAC,EAAE;MAAE,IAAII,IAAI,GAAGN,qBAAqB,GAAGpB,MAAM,CAACqB,wBAAwB,CAACR,GAAG,EAAES,GAAG,CAAC,GAAG,IAAI;MAAE,IAAII,IAAI,KAAKA,IAAI,CAACR,GAAG,IAAIQ,IAAI,CAACC,GAAG,CAAC,EAAE;QAAE3B,MAAM,CAACC,cAAc,CAACkB,MAAM,EAAEG,GAAG,EAAEI,IAAI,CAAC;MAAE,CAAC,MAAM;QAAEP,MAAM,CAACG,GAAG,CAAC,GAAGT,GAAG,CAACS,GAAG,CAAC;MAAE;IAAE;EAAE;EAAEH,MAAM,CAACJ,OAAO,GAAGF,GAAG;EAAE,IAAIG,KAAK,EAAE;IAAEA,KAAK,CAACW,GAAG,CAACd,GAAG,EAAEM,MAAM,CAAC;EAAE;EAAE,OAAOA,MAAM;AAAE;AACnyB,SAASS,QAAQA,CAACC,CAAC,EAAEC,CAAC,EAAE;EACtB,OAAOD,CAAC,KAAKC,CAAC;AAChB;AACA,MAAMC,YAAY,GAAG,CAAC,CAAC;AACvB,MAAMC,IAAI,GAAGA,CAAA,KAAM,CAAC,CAAC;;AAErB;AACA;AACA;AACA;AACA,SAASC,kBAAkBA,CAACC,aAAa,EAAEC,eAAe,EAAE;EAC1D,MAAMC,cAAc,GAAG,CAAC,CAAC,EAAE/B,SAAS,CAACU,OAAO,EAAE,CAAC,CAAC,EAAEmB,aAAa,CAAC;EAChElC,MAAM,CAACqC,IAAI,CAACF,eAAe,CAAC,CAACG,OAAO,CAAChB,GAAG,IAAI;IAC1C,IAAIa,eAAe,CAACb,GAAG,CAAC,KAAKiB,SAAS,EAAE;MACtCH,cAAc,CAACd,GAAG,CAAC,GAAGa,eAAe,CAACb,GAAG,CAAC;IAC5C;EACF,CAAC,CAAC;EACF,OAAOc,cAAc;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,SAASI,uBAAuBA,CAACC,UAAU,EAAE;EAC3C,MAAM;IACJC,SAAS;IACTC,YAAY;IACZC,cAAc;IACdC,aAAa;IACbV,eAAe;IACfW;EACF,CAAC,GAAGL,UAAU;EACd,MAAMM,wBAAwB,GAAGzC,KAAK,CAAC0C,MAAM,CAACL,YAAY,CAAC;EAC3DrC,KAAK,CAAC2C,SAAS,CAAC,MAAM;IACpB,IAAIH,aAAa,CAACI,OAAO,KAAK,IAAI,EAAE;MAClC;MACA;IACF;IACA,MAAMC,aAAa,GAAGlB,kBAAkB,CAACc,wBAAwB,CAACG,OAAO,EAAEf,eAAe,CAAC;IAC3FnC,MAAM,CAACqC,IAAI,CAACK,SAAS,CAAC,CAACJ,OAAO,CAAChB,GAAG,IAAI;MACpC,IAAI8B,mBAAmB;MACvB;MACA,MAAMC,aAAa,GAAG,CAACD,mBAAmB,GAAGR,cAAc,CAACtB,GAAG,CAAC,KAAK,IAAI,GAAG8B,mBAAmB,GAAGxB,QAAQ;MAC1G,MAAM0B,aAAa,GAAGZ,SAAS,CAACpB,GAAG,CAAC;MACpC,MAAMiC,iBAAiB,GAAGJ,aAAa,CAAC7B,GAAG,CAAC;MAC5C,IAAIiC,iBAAiB,IAAI,IAAI,IAAID,aAAa,IAAI,IAAI,IAAIC,iBAAiB,IAAI,IAAI,IAAID,aAAa,IAAI,IAAI,IAAIC,iBAAiB,IAAI,IAAI,IAAID,aAAa,IAAI,IAAI,IAAI,CAACD,aAAa,CAACC,aAAa,EAAEC,iBAAiB,CAAC,EAAE;QACtN,IAAIC,MAAM,EAAEC,KAAK;QACjBZ,aAAa,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,aAAa,CAAC,CAACW,MAAM,GAAGV,aAAa,CAACI,OAAO,CAACQ,KAAK,KAAK,IAAI,GAAGF,MAAM,GAAG,IAAI,EAAElC,GAAG,EAAEgC,aAAa,EAAE,CAACG,KAAK,GAAGX,aAAa,CAACI,OAAO,CAACS,IAAI,KAAK,IAAI,GAAGF,KAAK,GAAG,EAAE,EAAEf,SAAS,CAAC;MAC1M;IACF,CAAC,CAAC;IACFK,wBAAwB,CAACG,OAAO,GAAGR,SAAS;IAC5CI,aAAa,CAACI,OAAO,GAAG,IAAI;EAC9B,CAAC,EAAE,CAACH,wBAAwB,EAAEL,SAAS,EAAEI,aAAa,EAAED,aAAa,EAAED,cAAc,EAAET,eAAe,CAAC,CAAC;AAC1G;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS/B,sBAAsBA,CAACqC,UAAU,EAAE;EAC1C,MAAMK,aAAa,GAAGxC,KAAK,CAAC0C,MAAM,CAAC,IAAI,CAAC;EACxC,MAAM;IACJY,OAAO;IACPjB,YAAY;IACZR,eAAe,GAAGJ,YAAY;IAC9Ba,cAAc,GAAGb,YAAY;IAC7Bc,aAAa,GAAGb,IAAI;IACpB6B;EACF,CAAC,GAAGpB,UAAU;;EAEd;EACA,MAAMqB,0BAA0B,GAAGxD,KAAK,CAACyD,WAAW,CAAC,CAACC,KAAK,EAAEC,MAAM,KAAK;IACtEnB,aAAa,CAACI,OAAO,GAAGe,MAAM;IAC9B,MAAMC,eAAe,GAAGjC,kBAAkB,CAAC+B,KAAK,EAAE7B,eAAe,CAAC;IAClE,MAAMgC,QAAQ,GAAGP,OAAO,CAACM,eAAe,EAAED,MAAM,CAAC;IACjD,OAAOE,QAAQ;EACjB,CAAC,EAAE,CAAChC,eAAe,EAAEyB,OAAO,CAAC,CAAC;EAC9B,MAAM,CAAClB,SAAS,EAAE0B,QAAQ,CAAC,GAAG9D,KAAK,CAAC+D,UAAU,CAACP,0BAA0B,EAAEnB,YAAY,CAAC;;EAExF;EACA,MAAM2B,mBAAmB,GAAGhE,KAAK,CAACyD,WAAW,CAACE,MAAM,IAAI;IACtDG,QAAQ,CAAC,CAAC,CAAC,EAAE/D,SAAS,CAACU,OAAO,EAAE,CAAC,CAAC,EAAEkD,MAAM,EAAE;MAC1CM,OAAO,EAAEV;IACX,CAAC,CAAC,CAAC;EACL,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EACnBrB,uBAAuB,CAAC;IACtBE,SAAS;IACTC,YAAY;IACZC,cAAc,EAAEA,cAAc,IAAI,IAAI,GAAGA,cAAc,GAAGb,YAAY;IACtEc,aAAa,EAAEA,aAAa,IAAI,IAAI,GAAGA,aAAa,GAAGb,IAAI;IAC3DG,eAAe;IACfW;EACF,CAAC,CAAC;EACF,OAAO,CAACb,kBAAkB,CAACS,SAAS,EAAEP,eAAe,CAAC,EAAEmC,mBAAmB,CAAC;AAC9E"}